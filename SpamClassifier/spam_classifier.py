import numpy as np
import re
import string
import pickle
import os
import nltk
nltk.download('wordnet')
from nltk import WordNetLemmatizer as wnl

stopwords = ['i', 'me', 'my', 'myself', 'we', 'our', 'ours', 'ourselves', 'you', "you're", "you've", "you'll", "you'd", 'your', 'yours', 'yourself', 'yourselves', 'he', 'him', 'his', 'himself', 'she', "she's", 'her', 'hers', 'herself', 'it', "it's", 'its', 'itself', 'they', 'them', 'their', 'theirs', 'themselves', 'what', 'which', 'who', 'whom', 'this', 'that', "that'll", 'these', 'those', 'am', 'is', 'are', 'was', 'were', 'be', 'been', 'being', 'have', 'has', 'had', 'having', 'do', 'does', 'did', 'doing', 'a', 'an', 'the', 'and', 'but', 'if', 'or', 'because', 'as', 'until', 'while', 'of', 'at', 'by', 'for', 'with', 'about', 'against', 'between', 'into', 'through', 'during', 'before', 'after', 'above', 'below', 'to', 'from', 'up', 'down', 'in', 'out', 'on', 'off', 'over', 'under', 'again', 'further', 'then', 'once', 'here', 'there', 'when', 'where', 'why', 'how', 'all', 'any', 'both', 'each', 'few', 'more', 'most', 'other', 'some', 'such', 'no', 'nor', 'not', 'only', 'own', 'same', 'so', 'than', 'too', 'very', 's', 't', 'can', 'will', 'just', 'don', "don't", 'should', "should've", 'now', 'd', 'll', 'm', 'o', 're', 've', 'y', 'ain', 'aren', "aren't", 'couldn', "couldn't", 'didn', "didn't", 'doesn', "doesn't", 'hadn', "hadn't", 'hasn', "hasn't", 'haven', "haven't", 'isn', "isn't", 'ma', 'mightn', "mightn't", 'mustn', "mustn't", 'needn', "needn't", 'shan', "shan't", 'shouldn', "shouldn't", 'wasn', "wasn't", 'weren', "weren't", 'won', "won't", 'wouldn', "wouldn't"]


#============================================ Functions ============================================
def parse_text(text):
    text = text.lower()
    text = re.sub(r'\$[\s]*[0-9]+', ' MONEY ', text)
    text = re.sub(r'(dollar|dollars|usd|rupee|rupees|pounds|pound|inr|money)', ' MONEY ', text)
    text = re.sub(r'[0-9]+', ' NUMBER ', text)
    text = re.sub(r'[^\s]+(\s?)\@(\s?)[^\s]+', ' EMAIL ', text)
    text = re.sub(r'[^\s]*(\.com|\.in|\.co\.in|\.co\.uk)', ' LINK ', text)
    text = re.sub(r'(https|http)(\s?):(\s?)/(\s?)/(\s?)[^\s]*', ' LINK ', text)
    for punct in string.punctuation:
        text = text.replace(punct, ' ')
    return text

def tokenize(text):
    lst = text.split()
    if len(lst) == 0: return []
    fin_lst = []
    if lst[0] != "subject":  # particular to enron dataset since it begins with subject in all emails
        fin_lst.append(lst[0])
    for i in range(1, len(lst)):
        if len(lst[i]) <= 1: continue
        fin_lst.append(lst[i])
    return fin_lst

def rem_common_words(text):
    return [word for word in text if word not in stopwords]

def lemmatize_text(text):
    lemmatizer = wnl()
    return [lemmatizer.lemmatize(word) for word in text]

def process_text(text):
    text = parse_text(text)
    text_list = tokenize(text)
    text_list = rem_common_words(text_list)
    text_list = lemmatize_text(text_list)

    #remove duplicates
    text_list = list(set(text_list))
    return text_list

def convert_to_feature(text, indices):
    text_list = process_text(text)
    feature = np.zeros(len(indices), dtype=int)
    for word in text_list:
        if word in indices.keys():
            feature[indices[word]] = 1
    return feature
# ============================================ Functions ============================================

# LOAD model from pickle file
model_pkl_file = "spam_classifier_model.pkl"  
with open(model_pkl_file, 'rb') as file:  
    model = pickle.load(file)

indices = {'NUMBER': 0, 'please': 1, 'com': 2, 'EMAIL': 3, 'MONEY': 4, 'subject': 5, 'time': 6, 'get': 7, 'would': 8, 'need': 9, 'one': 10, 'know': 11, 'thanks': 12, 'message': 13, 'u': 14, 'LINK': 15, 'new': 16, 'information': 17, 'enron': 18, 'like': 19, 'day': 20, 'may': 21, 'email': 22, 'cc': 23, 'price': 24, 'also': 25, 'pm': 26, 'see': 27, 'sent': 28, 'make': 29, 'let': 30, 'business': 31, 'mail': 32, 'want': 33, 'best': 34, 'company': 35, 'year': 36, 'work': 37, 'take': 38, 'week': 39, 'number': 40, 'question': 41, 'today': 42, 'go': 43, 'call': 44, 'could': 45, 'service': 46, 'offer': 47, 'contact': 48, 'regard': 49, 'use': 50, 'free': 51, 'order': 52, 'attached': 53, 'system': 54, 'date': 55, 'deal': 56, 'group': 57, 'look': 58, 'month': 59, 'change': 60, 'next': 61, 'help': 62, 'name': 63, 'last': 64, 'send': 65, 'good': 66, 'click': 67, 'forward': 68, 'original': 69, 'list': 70, 'site': 71, 'well': 72, 'following': 73, 'thank': 74, 'way': 75, 'available': 76, 'gas': 77, 'product': 78, 'hou': 79, 'market': 80, 'address': 81, 'back': 82, 'th': 83, 'two': 84, 'office': 85, 'first': 86, 'many': 87, 'made': 88, 'report': 89, 'future': 90, 'vince': 91, 'forwarded': 92, 'find': 93, 'net': 94, 'online': 95, 'start': 96, 'hour': 97, 'file': 98, 'risk': 99, 'corp': 100, 'give': 101, 'right': 102, 'energy': 103, 'result': 104, 'within': 105, 'phone': 106, 'customer': 107, 'people': 108, 'much': 109, 'note': 110, 'provide': 111, 'management': 112, 'meeting': 113, 'power': 114, 'great': 115, 'state': 116, 'due': 117, 'come': 118, 'think': 119, 'receive': 120, 'based': 121, 'process': 122, 'security': 123, 'issue': 124, 'visit': 125, 'million': 126, 'line': 127, 'interest': 128, 'fax': 129, 'term': 130, 'detail': 131, 'sale': 132, 'without': 133, 'current': 134, 'looking': 135, 'part': 136, 'home': 137, 'plan': 138, 'per': 139, 'cost': 140, 'project': 141, 'must': 142, 'long': 143, 'houston': 144, 'since': 145, 'review': 146, 'high': 147, 'world': 148, 'going': 149, 'account': 150, 'request': 151, 'software': 152, 'end': 153, 'friday': 154, 'even': 155, 'position': 156, 'still': 157, 'wish': 158, 'set': 159, 'program': 160, 'possible': 161, 'place': 162, 'total': 163, 'form': 164, 'problem': 165, 'team': 166, 'stop': 167, 'working': 168, 'check': 169, 'received': 170, 'schedule': 171, 'contract': 172, 'full': 173, 'buy': 174, 'save': 175, 'opportunity': 176, 'include': 177, 'keep': 178, 'ect': 179, 'thing': 180, 'dear': 181, 'monday': 182, 'rate': 183, 'link': 184, 'interested': 185, 'including': 186, 'trading': 187, 'might': 188, 'website': 189, 'life': 190, 'feel': 191, 'investment': 192, 'soon': 193, 'research': 194, 'america': 195, 'inc': 196, 'support': 197, 'special': 198, 'able': 199, 'currently': 200, 'hi': 201, 'additional': 202, 'believe': 203, 'copy': 204, 'kaminski': 205, 'every': 206, 'john': 207, 'hope': 208, 'reply': 209, 'financial': 210, 'however': 211, 'act': 212, 'web': 213, 'credit': 214, 'info': 215, 'regarding': 216, 'real': 217, 'louise': 218, 'point': 219, 'update': 220, 'professional': 221, 'le': 222, 'final': 223, 'transaction': 224, 'pay': 225, 'used': 226, 'trade': 227, 'news': 228, 'already': 229, 'party': 230, 'stock': 231, 'manager': 232, 'sure': 233, 'value': 234, 'internet': 235, 'required': 236, 'development': 237, 'using': 238, 'low': 239, 'say': 240, 'notice': 241, 'access': 242, 'effort': 243, 'three': 244, 'provided': 245, 'fw': 246, 'director': 247, 'thursday': 248, 'volume': 249, 'country': 250, 'data': 251, 'move': 252, 'operation': 253, 'continue': 254, 'hello': 255, 'morning': 256, 'event': 257, 'put': 258, 'marketing': 259, 'california': 260, 'agreement': 261, 'mark': 262, 'meet': 263, 'cash': 264, 'thousand': 265, 'increase': 266, 'member': 267, 'fact': 268, 'area': 269, 'read': 270, 'share': 271, 'show': 272, 'complete': 273, 'said': 274, 'north': 275, 'another': 276, 'international': 277, 'better': 278, 'discussion': 279, 'david': 280, 'given': 281, 'done': 282, 'sell': 283, 'industry': 284, 'quality': 285, 'mr': 286, 'fund': 287, 'action': 288, 'tuesday': 289, 'type': 290, 'option': 291, 'wednesday': 292, 'view': 293, 'co': 294, 'several': 295, 'past': 296, 'top': 297, 'getting': 298, 'limited': 299, 'delivery': 300, 'person': 301, 'second': 302, 'really': 303, 'www': 304, 'resource': 305, 'try': 306, 'lot': 307, 'purchase': 308, 'needed': 309, 'legal': 310, 'discus': 311, 'technology': 312, 'bill': 313, 'little': 314, 'minute': 315, 'department': 316, 'case': 317, 'performance': 318, 'word': 319, 'communication': 320, 'mailing': 321, 'individual': 322, 'prior': 323, 'material': 324, 'user': 325, 'never': 326, 'version': 327, 'private': 328, 'remove': 329, 'around': 330, 'bank': 331, 'control': 332, 'level': 333, 'amount': 334, 'immediately': 335, 'follow': 336, 'effective': 337, 'got': 338, 'watch': 339, 'paid': 340, 'important': 341, 'short': 342, 'source': 343, 'shall': 344, 'july': 345, 'comment': 346, 'via': 347, 'easy': 348, 'kind': 349, 'reason': 350, 'application': 351, 'necessary': 352, 'thought': 353, 'ready': 354, 'either': 355, 'january': 356, 'others': 357, 'computer': 358, 'iso': 359, 'june': 360, 'payment': 361, 'approved': 362, 'experience': 363, 'united': 364, 'always': 365, 'talk': 366, 'third': 367, 'april': 368, 'anything': 369, 'cannot': 370, 'error': 371, 'daily': 372, 'general': 373, 'robert': 374, 'texas': 375, 'hpl': 376, 'ask': 377, 'found': 378, 'content': 379, 'etc': 380, 'later': 381, 'section': 382, 'statement': 383, 'book': 384, 'natural': 385, 'president': 386, 'march': 387, 'potential': 388, 'response': 389, 'exchange': 390, 'return': 391, 'release': 392, 'employee': 393, 'yet': 394, 'ever': 395, 'partner': 396, 'upon': 397, 'commercial': 398, 'public': 399, 'letter': 400, 'october': 401, 'certain': 402, 'wanted': 403, 'fee': 404, 'asset': 405, 'sincerely': 406, 'open': 407, 'hard': 408, 'success': 409, 'together': 410, 'supply': 411, 'purpose': 412, 'making': 413, 'mean': 414, 'mike': 415, 'id': 416, 'key': 417, 'st': 418, 'html': 419, 'add': 420, 'global': 421, 'approval': 422, 'removed': 423, 'cause': 424, 'center': 425, 'benefit': 426, 'solution': 427, 'charge': 428, 'document': 429, 'late': 430, 'therefore': 431, 'kitchen': 432, 'big': 433, 'related': 434, 'production': 435, 'michael': 436, 'different': 437, 'run': 438, 'direct': 439, 'remember': 440, 'desk': 441, 'page': 442, 'investor': 443, 'fast': 444, 'held': 445, 'finance': 446, 'concern': 447, 'august': 448, 'viagra': 449, 'recent': 450, 'daren': 451, 'asked': 452, 'bring': 453, 'confidential': 454, 'december': 455, 'become': 456, 'model': 457, 'claim': 458, 'window': 459, 'conference': 460, 'advice': 461, 'receiving': 462, 'portland': 463, 'close': 464, 'expected': 465, 'basis': 466, 'large': 467, 'estimate': 468, 'friend': 469, 'begin': 470, 'ca': 471, 'addition': 472, 'hand': 473, 'man': 474, 'steve': 475, 'happy': 476, 'create': 477, 'november': 478, 'london': 479, 'latest': 480, 'reference': 481, 'unit': 482, 'simply': 483, 'everyone': 484, 'fyi': 485, 'september': 486, 'flow': 487, 'matter': 488, 'effect': 489, 'corporate': 490, 'major': 491, 'something': 492, 'firm': 493, 'completed': 494, 'canada': 495, 'decision': 496, 'family': 497, 'prescription': 498, 'expect': 499, 'quick': 500, 'hundred': 501, 'government': 502, 'transfer': 503, 'scheduling': 504, 'respect': 505, 'personal': 506, 'period': 507, 'example': 508, 'suite': 509, 'jeff': 510, 'tel': 511, 'love': 512, 'idea': 513, 'staff': 514, 'php': 515, 'away': 516, 'activity': 517, 'small': 518, 'tomorrow': 519, 'unsubscribe': 520, 'status': 521, 'join': 522, 'press': 523, 'aware': 524, 'anyone': 525, 'non': 526, 'course': 527, 'brand': 528, 'de': 529, 'log': 530, 'worldwide': 531, 'item': 532, 'actual': 533, 'five': 534, 'bob': 535, 'included': 536, 'operating': 537, 'longer': 538, 'seek': 539, 'nothing': 540, 'taking': 541, 'title': 542, 'contains': 543, 'mind': 544, 'early': 545, 'growth': 546, 'assistance': 547, 'organization': 548, 'hot': 549, 'officer': 550, 'representative': 551, 'al': 552, 'directly': 553, 'someone': 554, 'size': 555, 'meter': 556, 'capital': 557, 'executive': 558, 'allow': 559, 'specific': 560, 'among': 561, 'goal': 562, 'street': 563, 'mobile': 564, 'ticket': 565, 'standard': 566, 'confirm': 567, 'ago': 568, 'drug': 569, 'chance': 570, 'smith': 571, 'four': 572, 'includes': 573, 'record': 574, 'europe': 575, 'wide': 576, 'newsletter': 577, 'revenue': 578, 'job': 579, 'oil': 580, 'requirement': 581, 'identified': 582, 'secure': 583, 'plant': 584, 'presentation': 585, 'med': 586, 'registered': 587, 'selected': 588, 'told': 589, 'network': 590, 'learn': 591, 'university': 592, 'attention': 593, 'ability': 594, 'whether': 595, 'loss': 596, 'head': 597, 'various': 598, 'understand': 599, 'demand': 600, 'present': 601, 'oo': 602, 'left': 603, 'doc': 604, 'guarantee': 605, 'city': 606, 'huge': 607, 'kevin': 608, 'featured': 609, 'pro': 610, 'least': 611, 'strong': 612, 'step': 613, 'enough': 614, 'recently': 615, 'along': 616, 'telephone': 617, 'fill': 618, 'box': 619, 'february': 620, 'considered': 621, 'client': 622, 'answer': 623, 'everything': 624, 'associate': 625, 'objective': 626, 'property': 627, 'analysis': 628, 'ensure': 629, 'condition': 630, 'gain': 631, 'microsoft': 632, 'require': 633, 'requested': 634, 'coming': 635, 'ena': 636, 'positive': 637, 'side': 638, 'accounting': 639, 'far': 640, 'tell': 641, 'target': 642, 'shipping': 643, 'west': 644, 'profit': 645, 'room': 646, 'listed': 647, 'profile': 648, 'mentioned': 649, 'safe': 650, 'probably': 651, 'download': 652, 'american': 653, 'tax': 654, 'stand': 655, 'package': 656, 'write': 657, 'sum': 658, 'pill': 659, 'database': 660, 'guy': 661, 'location': 662, 'house': 663, 'expense': 664, 'search': 665, 'else': 666, 'known': 667, 'scheduled': 668, 'distribution': 669, 'choose': 670, 'cover': 671, 'shirley': 672, 'significant': 673, 'board': 674, 'called': 675, 'federal': 676, 'intended': 677, 'store': 678, 'design': 679, 'hourahead': 680, 'sally': 681, 'na': 682, 'sign': 683, 'appreciate': 684, 'uncertainty': 685, 'old': 686, 'interview': 687, 'half': 688, 'offering': 689, 'added': 690, 'yahoo': 691, 'policy': 692, 'law': 693, 'jan': 694, 'factor': 695, 'lose': 696, 'clear': 697, 'afternoon': 698, 'investing': 699, 'pricing': 700, 'capacity': 701, 'plus': 702, 'paper': 703, 'focus': 704, 'awarded': 705, 'strategy': 706, 'hold': 707, 'night': 708, 'yesterday': 709, 'opinion': 710, 'care': 711, 'discount': 712, 'sorry': 713, 'jones': 714, 'higher': 715, 'men': 716, 'woman': 717, 'participant': 718, 'mary': 719, 'range': 720, 'agent': 721, 'corporation': 722, 'mid': 723, 'according': 724, 'james': 725, 'enter': 726, 'sold': 727, 'trader': 728, 'health': 729, 'impact': 730, 'trying': 731, 'entire': 732, 'field': 733, 'though': 734, 'billion': 735, 'none': 736, 'medication': 737, 'cheap': 738, 'official': 739, 'occur': 740, 'drive': 741, 'meaning': 742, 'agreed': 743, 'involved': 744, 'quickly': 745, 'welcome': 746, 'worth': 747, 'txt': 748, 'belief': 749, 'solicitation': 750, 'chris': 751, 'notification': 752, 'equity': 753, 'reach': 754, 'card': 755, 'pipeline': 756, 'discussed': 757, 'draft': 758, 'south': 759, 'code': 760, 'successful': 761, 'richard': 762, 'express': 763, 'national': 764, 'logo': 765, 'assist': 766, 'building': 767, 'highly': 768, 'sex': 769, 'lead': 770, 'mmbtu': 771, 'guaranteed': 772, 'school': 773, 'tool': 774, 'similar': 775, 'average': 776, 'text': 777, 'near': 778, 'immediate': 779, 'wait': 780, 'assumption': 781, 'uk': 782, 'decided': 783, 'pleased': 784, 'expectation': 785, 'promotion': 786, 'situation': 787, 'nice': 788, 'senior': 789, 'perfect': 790, 'compliance': 791, 'leading': 792, 'parsing': 793, 'advantage': 794, 'live': 795, 'normal': 796, 'farmer': 797, 'sending': 798, 'format': 799, 'westdesk': 800, 'creative': 801, 'usa': 802, 'la': 803, 'dave': 804, 'starting': 805, 'shop': 806, 'existing': 807, 'announced': 808, 'anticipated': 809, 'body': 810, 'analyst': 811, 'choice': 812, 'simple': 813, 'east': 814, 'providing': 815, 'adobe': 816, 'lower': 817, 'avoid': 818, 'taken': 819, 'dr': 820, 'retail': 821, 'expects': 822, 'cd': 823, 'el': 824, 'base': 825, 'turn': 826, 'managing': 827, 'appropriate': 828, 'weekend': 829, 'inform': 830, 'subscriber': 831, 'represent': 832, 'increased': 833, 'role': 834, 'responsibility': 835, 'agree': 836, 'eb': 837, 'variance': 838, 'play': 839, 'seen': 840, 'draw': 841, 'provides': 842, 'owner': 843, 'differ': 844, 'ceo': 845, 'portfolio': 846, 'stay': 847, 'mailto': 848, 'although': 849, 'reader': 850, 'xl': 851, 'advisor': 852, 'respond': 853, 'front': 854, 'summary': 855, 'sheet': 856, 'outstanding': 857, 'earlier': 858, 'ancillary': 859, 'yes': 860, 'delay': 861, 'graphic': 862, 'selling': 863, 'involve': 864, 'bit': 865, 'fixed': 866, 'soft': 867, 'came': 868, 'advertisement': 869, 'talking': 870, 'super': 871, 'six': 872, 'created': 873, 'reporting': 874, 'receipt': 875, 'across': 876, 'saving': 877, 'local': 878, 'structure': 879, 'hear': 880, 'bad': 881, 'facility': 882, 'changed': 883, 'build': 884, 'image': 885, 'category': 886, 'confirmation': 887, 'announcement': 888, 'planning': 889, 'xp': 890, 'couple': 891, 'loan': 892, 'updated': 893, 'org': 894, 'follows': 895, 'history': 896, 'took': 897, 'foreign': 898, 'quarter': 899, 'membership': 900, 'outside': 901, 'proposal': 902, 'likely': 903, 'video': 904, 'herein': 905, 'develop': 906, 'edu': 907, 'detected': 908, 'contained': 909, 'scott': 910, 'broker': 911, 'consider': 912, 'doctor': 913, 'stated': 914, 'conflict': 915, 'pre': 916, 'commission': 917, 'air': 918, 'whole': 919, 'tx': 920, 'holding': 921, 'cialis': 922, 'tom': 923, 'attend': 924, 'single': 925, 'relationship': 926, 'test': 927, 'balance': 928, 'affiliate': 929, 'resume': 930, 'otherwise': 931, 'summer': 932, 'moving': 933, 'fully': 934, 'nd': 935, 'feature': 936, 'commodity': 937, 'rest': 938, 'york': 939, 'correct': 940, 'track': 941, 'previous': 942, 'instruction': 943, 'proposed': 944, 'responsible': 945, 'fuel': 946, 'bankruptcy': 947, 'understanding': 948, 'publication': 949, 'utility': 950, 'nom': 951, 'reserve': 952, 'pc': 953, 'failure': 954, 'cell': 955, 'medium': 956, 'biz': 957, 'entered': 958, 'leader': 959, 'instead': 960, 'filing': 961, 'greg': 962, 'wholesale': 963, 'quote': 964, 'understood': 965, 'running': 966, 'projection': 967, 'consumer': 968, 'lost': 969, 'server': 970, 'waiting': 971, 'pain': 972, 'accept': 973, 'placed': 974, 'tried': 975, 'indicating': 976, 'williams': 977, 'child': 978, 'leave': 979, 'double': 980, 'exactly': 981, 'vice': 982, 'chief': 983, 'suggestion': 984, 'chairman': 985, 'deliver': 986, 'ok': 987, 'jim': 988, 'electricity': 989, 'participate': 990, 'beginning': 991, 'revised': 992, 'independent': 993, 'generation': 994, 'finally': 995, 'congratulation': 996, 'rd': 997, 'lowest': 998, 'm': 999, 'signed': 1000, 'floor': 1001, 'trust': 1002, 'door': 1003, 'physical': 1004, 'alternative': 1005, 'popular': 1006, 'acquisition': 1007, 'transmission': 1008, 'presently': 1009, 'annual': 1010, 'mx': 1011, 'stinson': 1012, 'unique': 1013, 'reliable': 1014, 'met': 1015, 'generic': 1016, 'age': 1017, 'hearing': 1018, 'historical': 1019, 'region': 1020, 'heard': 1021, 'actually': 1022, 'approximately': 1023, 'voice': 1024, 'advise': 1025, 'invest': 1026, 'class': 1027, 'compensation': 1028, 'fall': 1029, 'construed': 1030, 'started': 1031, 'rather': 1032, 'extra': 1033, 'arrangement': 1034, 'initial': 1035, 'acceptance': 1036, 'monthly': 1037, 'accuracy': 1038, 'studio': 1039, 'post': 1040, 'committee': 1041, 'ship': 1042, 'promotional': 1043, 'ahead': 1044, 'availability': 1045, 'main': 1046, 'pick': 1047, 'medical': 1048, 'prediction': 1049, 'proven': 1050, 'worked': 1051, 'income': 1052, 'multiple': 1053, 'entity': 1054, 'shareholder': 1055, 'index': 1056, 'iii': 1057, 'spam': 1058, 'ee': 1059, 'brian': 1060, 'paul': 1061, 'weekly': 1062, 'associated': 1063, 'remain': 1064, 'raise': 1065, 'debt': 1066, 'crenshaw': 1067, 'nomination': 1068, 'issued': 1069, 'growing': 1070, 'sir': 1071, 'anticipates': 1072, 'failed': 1073, 'almost': 1074, 'giving': 1075, 'financing': 1076, 'fit': 1077, 'central': 1078, 'developed': 1079, 'critical': 1080, 'technical': 1081, 'training': 1082, 'cut': 1083, 'largest': 1084, 'seems': 1085, 'sector': 1086, 'sec': 1087, 'select': 1088, 'ed': 1089, 'true': 1090, 'load': 1091, 'mix': 1092, 'advised': 1093, 'hr': 1094, 'black': 1095, 'passed': 1096, 'grant': 1097, 'face': 1098, 'processing': 1099, 'george': 1100, 'spreadsheet': 1101, 'identify': 1102, 'photoshop': 1103, 'student': 1104, 'approach': 1105, 'award': 1106, 'edition': 1107, 'red': 1108, 'ten': 1109, 'electronic': 1110, 'enjoy': 1111, 'hit': 1112, 'knowledge': 1113, 'provider': 1114, 'boost': 1115, 'gary': 1116, 'dealer': 1117, 'understands': 1118, 'submit': 1119, 'pas': 1120, 'percent': 1121, 'table': 1122, 'common': 1123, 'san': 1124, 'study': 1125, 'intend': 1126, 'expert': 1127, 'cap': 1128, 'reserved': 1129, 'deciding': 1130, 'dec': 1131, 'urgent': 1132, 'developing': 1133, 'competitive': 1134, 'force': 1135, 'difference': 1136, 'tim': 1137, 'agency': 1138, 'pertaining': 1139, 'white': 1140, 'manage': 1141, 'corel': 1142, 'feedback': 1143, 'copyright': 1144, 'session': 1145, 'acquire': 1146, 'internal': 1147, 'inherent': 1148, 'timing': 1149, 'picture': 1150, 'wife': 1151, 'alert': 1152, 'fine': 1153, 'spoke': 1154, 'girl': 1155, 'measure': 1156, 'confidentiality': 1157, 'delivered': 1158, 'went': 1159, 'strictly': 1160, 'story': 1161, 'thomas': 1162, 'automatically': 1163, 'attempt': 1164, 'behalf': 1165, 'young': 1166, 'obligation': 1167, 'deposit': 1168, 'speak': 1169, 'happen': 1170, 'industrial': 1171, 'economic': 1172, 'previously': 1173, 'light': 1174, 'storage': 1175, 'designed': 1176, 'lon': 1177, 'beck': 1178, 'released': 1179, 'handle': 1180, 'active': 1181, 'sexual': 1182, 'method': 1183, 'et': 1184, 'reduce': 1185, 'determine': 1186, 'willing': 1187, 'derivative': 1188, 'brown': 1189, 'privacy': 1190, 'environment': 1191, 'sound': 1192, 'maybe': 1193, 'resulting': 1194, 'thinking': 1195, 'spot': 1196, 'quite': 1197, 'european': 1198, 'martin': 1199, 'wiil': 1200, 'budget': 1201, 'game': 1202, 'estimated': 1203, 'confidence': 1204, 'feb': 1205, 'browser': 1206, 'distribute': 1207, 'competitor': 1208, 'especially': 1209, 'contain': 1210, 'mortgage': 1211, 'commitment': 1212, 'overall': 1213, 'community': 1214, 'convenience': 1215, 'trip': 1216, 'unless': 1217, 'self': 1218, 'electric': 1219, 'secret': 1220, 'andrew': 1221, 'advance': 1222, 'producer': 1223, 'closed': 1224, 'winner': 1225, 'speed': 1226, 'materially': 1227, 'eol': 1228, 'rick': 1229, 'conversation': 1230, 'penny': 1231, 'ltd': 1232, 'break': 1233, 'weight': 1234, 'reached': 1235, 'article': 1236, 'assistant': 1237, 'throughout': 1238, 'venture': 1239, 'drew': 1240, 'aggressive': 1241, 'susan': 1242, 'winning': 1243, 'bottom': 1244, 'sitara': 1245, 'located': 1246, 'candidate': 1247, 'lst': 1248, 'subsidiary': 1249, 'foresee': 1250, 'buying': 1251, 'absolutely': 1252, 'seeing': 1253, 'premium': 1254, 'eye': 1255, 'function': 1256, 'weather': 1257, 'joe': 1258, 'bid': 1259, 'lisa': 1260, 'respective': 1261, 'equipment': 1262, 'ii': 1263, 'powerful': 1264, 'settlement': 1265, 'entertainment': 1266, 'recipient': 1267, 'remaining': 1268, 'transportation': 1269, 'africa': 1270, 'advertising': 1271, 'pg': 1272, 'wi': 1273, 'particular': 1274, 'achieve': 1275, 'procedure': 1276, 'owned': 1277, 'taylor': 1278, 'reflect': 1279, 'macromedia': 1280, 'serve': 1281, 'william': 1282, 'screen': 1283, 'c': 1284, 'advises': 1285, 'space': 1286, 'moment': 1287, 'water': 1288, 'frank': 1289, 'path': 1290, 'participation': 1291, 'counterparty': 1292, 'apply': 1293, 'moved': 1294, 'ken': 1295, 'ad': 1296, 'invitation': 1297, 'detailed': 1298, 'suggested': 1299, 'verify': 1300, 'insurance': 1301, 'michelle': 1302, 'nov': 1303, 'sender': 1304, 'correspondence': 1305, 'regulatory': 1306, 'protect': 1307, 'gave': 1308, 'spent': 1309, 'julie': 1310, 'agenda': 1311, 'se': 1312, 'offered': 1313, 'continuing': 1314, 'password': 1315, 'listing': 1316, 'requires': 1317, 'zone': 1318, 'attachment': 1319, 'hey': 1320, 'oct': 1321, 'limit': 1322, 'death': 1323, 'charset': 1324, 'green': 1325, 'obtain': 1326, 'symbol': 1327, 'banking': 1328, 'unable': 1329, 'saturday': 1330, 'multi': 1331, 'enable': 1332, 'improve': 1333, 'recommendation': 1334, 'indicated': 1335, 'master': 1336, 'jeffrey': 1337, 'importance': 1338, 'transport': 1339, 'written': 1340, 'advanced': 1341, 'writing': 1342, 'pharmacy': 1343, 'difficult': 1344, 'continued': 1345, 'manual': 1346, 'spend': 1347, 'extremely': 1348, 'lavorato': 1349, 'thus': 1350, 'pleasure': 1351, 'buyer': 1352, 'paste': 1353, 'cent': 1354, 'travel': 1355, 'alone': 1356, 'processed': 1357, 'paying': 1358, 'produce': 1359, 'human': 1360, 'touch': 1361, 'miss': 1362, 'pat': 1363, 'language': 1364, 'input': 1365, 'foot': 1366, 'greater': 1367, 'behind': 1368, 'lunch': 1369, 'strategic': 1370, 'identity': 1371, 'connection': 1372, 'custom': 1373, 'shown': 1374, 'delete': 1375, 'valuable': 1376, 'negative': 1377, 'priority': 1378, 'acrobat': 1379, 'western': 1380, 'primary': 1381, 'rule': 1382, 'engine': 1383, 'extended': 1384, 'en': 1385, 'enterprise': 1386, 'biggest': 1387, 'improvement': 1388, 'stage': 1389, 'informed': 1390, 'suggest': 1391, 'description': 1392, 'progress': 1393, 'holiday': 1394, 'sense': 1395, 'paso': 1396, 'stationery': 1397, 'disclosure': 1398, 'litigation': 1399, 'curve': 1400, 'exclusive': 1401, 'glad': 1402, 'drop': 1403, 'enrononline': 1404, 'steven': 1405, 'car': 1406, 'diligence': 1407, 'submitted': 1408, 'mw': 1409, 'practice': 1410, 'e': 1411, 'lucky': 1412, 'competition': 1413, 'lay': 1414, 'partnership': 1415, 'export': 1416, 'coordinator': 1417, 'paragraph': 1418, 'prize': 1419, 'ref': 1420, 'ce': 1421, 'posted': 1422, 'relation': 1423, 'wall': 1424, 'affiliated': 1425, 'direction': 1426, 'topic': 1427, 'breaking': 1428, 'bonus': 1429, 'neither': 1430, 'intent': 1431, 'evening': 1432, 'count': 1433, 'seven': 1434, 'broadband': 1435, 'oem': 1436, 'fun': 1437, 'returned': 1438, 'tab': 1439, 'allen': 1440, 'easily': 1441, 'assurance': 1442, 'match': 1443, 'chair': 1444, 'merchant': 1445, 'pr': 1446, 'duty': 1447, 'road': 1448, 'mm': 1449, 'talked': 1450, 'announce': 1451, 'rm': 1452, 'opt': 1453, 'publisher': 1454, 'relief': 1455, 'assume': 1456, 'expressed': 1457, 'desire': 1458, 'davis': 1459, 'sunday': 1460, 'preferred': 1461, 'former': 1462, 'negotiation': 1463, 'reform': 1464, 'middle': 1465, 'satisfaction': 1466, 'wrote': 1467, 'campaign': 1468, 'gone': 1469, 'notify': 1470, 'player': 1471, 'anywhere': 1472, 'pressure': 1473, 'hall': 1474, 'grow': 1475, 'bought': 1476, 'earnings': 1477, 'print': 1478, 'exposure': 1479, 'valuation': 1480, 'perhaps': 1481, 'appears': 1482, 'entry': 1483, 'emerging': 1484, 'produced': 1485, 'administration': 1486, 'engineering': 1487, 'rating': 1488, 'alias': 1489, 'movie': 1490, 'lee': 1491, 'god': 1492, 'seeking': 1493, 'vacation': 1494, 'protocol': 1495, 'drawn': 1496, 'whatever': 1497, 'reduced': 1498, 'norton': 1499, 'hotel': 1500, 'star': 1501, 'colleague': 1502, 'llc': 1503, 'rob': 1504, 'kept': 1505, 'serial': 1506, 'confirmed': 1507, 'tw': 1508, 'speculative': 1509, 'capability': 1510, 'heart': 1511, 'allows': 1512, 'ex': 1513, 'un': 1514, 'valid': 1515, 'highest': 1516, 'carry': 1517, 'gibner': 1518, 'batch': 1519, 'focused': 1520, 'sa': 1521, 'fresh': 1522, 'closing': 1523, 'possibility': 1524, 'contacted': 1525, 'nearly': 1526, 'serious': 1527, 'consequently': 1528, 'kim': 1529, 'registration': 1530, 'skill': 1531, 'affordable': 1532, 'ph': 1533, 'plain': 1534, 'committed': 1535, 'treatment': 1536, 'whose': 1537, 'deadline': 1538, 'appointment': 1539, 'setting': 1540, 'calendar': 1541, 'personnel': 1542, 'series': 1543, 'easier': 1544, 'figure': 1545, 'wil': 1546, 'maintain': 1547, 'lottery': 1548, 'referenced': 1549, 'ar': 1550, 'asking': 1551, 'southern': 1552, 'art': 1553, 'gathered': 1554, 'construction': 1555, 'melissa': 1556, 'christopher': 1557, 'compared': 1558, 'spread': 1559, 'published': 1560, 'platform': 1561, 'wrong': 1562, 'finding': 1563, 'son': 1564, 'continues': 1565, 'pending': 1566, 'variety': 1567, 'dow': 1568, 'gift': 1569, 'brief': 1570, 'built': 1571, 'profitable': 1572, 'reported': 1573, 'core': 1574, 'hence': 1575, 'otc': 1576, 'rich': 1577, 'ail': 1578, 'interesting': 1579, 'stream': 1580, 'introduce': 1581, 'stephen': 1582, 'regular': 1583, 'photo': 1584, 'gold': 1585, 'concerned': 1586, 'increasing': 1587, 'barry': 1588, 'economy': 1589, 'operational': 1590, 'clean': 1591, 'ferc': 1592, 'register': 1593, 'protection': 1594, 'unlimited': 1595, 'decide': 1596, 'prepared': 1597, 'stake': 1598, 'often': 1599, 'url': 1600, 'pretty': 1601, 'happening': 1602, 'operate': 1603}

def predict_email(text, indices):
    X_feature = [convert_to_feature(text, indices)]
    y_pred = model.predict(X_feature)
    return y_pred[0]

def classifier():
    folder_path = './test'
    files = os.listdir(folder_path)
    for file_name in files :
        file_path = os.path.join(folder_path, file_name)
        if os.path.isfile(file_path):
            with open(file_path, 'r', encoding='latin-1') as file:
                content = file.read()
                y = predict_email(content, indices)
                print(y)

classifier()
